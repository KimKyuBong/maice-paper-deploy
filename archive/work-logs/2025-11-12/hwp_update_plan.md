# HWP 논문 내용 업데이트 계획

## 📊 현황 분석

### 기존 문서 (hwp/report.hwpx)
- **형식**: HWP 문서
- **페이지**: 184페이지
- **크기**: 1.5MB
- **제목**: "수학 학습에서 질문 명료화를 지원하는 AI에이전트 설계 및 개발"
- **특징**: 완성된 양식, 서식, 스타일 포함

### 수정된 내용 (docs/chapters/*.md)
- **형식**: Markdown 파일 (18개 파일)
- **예상 페이지**: 약 170페이지 (축소됨)
- **구조**: 챕터별로 모듈화됨
- **변경 사항**: 내용 개선 및 축소

### 목표
✅ **양식/스타일 유지** + **내용만 교체**

---

## 🎯 전략 수립

### 방법 A: 섹션별 직접 교체 (추천 ⭐)

**장점:**
- 기존 서식 100% 유지
- 표, 그림 캡션, 페이지 설정 보존
- 단계별 검증 가능

**단점:**
- 시간 소요 (하지만 가장 안전)
- 수동 작업 필요

**구현 방법:**
1. 기존 HWP 문서 열기
2. 각 챕터별로:
   - 기존 텍스트 선택 (제목 제외)
   - Markdown 내용으로 교체
   - 서식 재적용 (볼드, 이탤릭 등)
3. 표/그림은 별도 처리
4. 저장

### 방법 B: 새 문서 생성 후 스타일 복사

**장점:**
- 클린 스타트
- 자동화 가능성

**단점:**
- 기존 스타일 재현 어려움
- 표/그림 위치 조정 필요
- 페이지 설정 재작업

---

## 📝 상세 실행 계획 (방법 A 기반)

### Phase 1: 준비 및 분석 (5분)
```
1. Markdown 파일 전체 읽기 및 파싱
2. 기존 HWP 문서 구조 매핑
   - 챕터 경계 확인
   - 제목 스타일 분석
   - 특수 요소 위치 파악 (표, 그림)
3. 매핑 테이블 생성
```

### Phase 2: 자동 교체 스크립트 개발 (30분)
```python
# 핵심 로직
1. 각 챕터 식별 (제목으로 구분)
2. 챕터 내용 전체 선택
3. Markdown 내용 변환 (마크다운 → HWP 텍스트)
   - **볼드** → HWP 볼드
   - *이탤릭* → HWP 이탤릭
   - 리스트 → HWP 리스트
4. 교체 및 서식 적용
5. 검증
```

### Phase 3: 챕터별 교체 (60분)
```
순서대로 교체:
1. 서론 (01-introduction.md)
2. 이론적 배경 (02-theoretical-background.md)
3. 시스템 설계 (03-system-design.md)
4. 시스템 구현 (04-system-implementation.md)
5. 연구 방법 (05-research-methods.md)
6. 결과 (06-results.md)
7. 논의 및 결론 (07-discussion-conclusion.md)
8. 참고문헌 (08-references.md)

각 챕터마다:
- 교체 전 백업
- 내용 교체
- 서식 확인
- 다음 챕터로
```

### Phase 4: 특수 요소 처리 (30분)
```
1. 표 차례 업데이트
2. 그림 차례 업데이트
3. 목차 재생성
4. 페이지 번호 확인
5. 참고문헌 형식 통일
```

### Phase 5: 검증 및 마무리 (15분)
```
1. 전체 문서 읽기 테스트
2. 서식 일관성 확인
3. 페이지 수 확인
4. 최종 저장
5. 백업 생성
```

---

## 🔧 기술적 고려사항

### Markdown → HWP 변환 규칙

```python
CONVERSION_RULES = {
    # 제목
    "# ": "제목1 스타일",
    "## ": "제목2 스타일",
    "### ": "제목3 스타일",
    
    # 서식
    "**text**": "볼드체",
    "*text*": "이탤릭",
    "`code`": "코드 스타일",
    
    # 리스트
    "- item": "글머리 기호",
    "1. item": "번호 매기기",
    
    # 인용
    "> quote": "인용 스타일",
    
    # 특수
    "---": "구분선",
    "[link]": "하이퍼링크",
}
```

### HWP 조작 주요 메서드

```python
# 챕터 찾기
hwp.find("Ⅰ. 서 론")

# 내용 선택
hwp.Run("MoveDocBegin")
hwp.Run("SelectAll")

# 텍스트 교체
hwp.insert_text(new_content)

# 서식 적용
hwp.set_font(Bold=True, Height=14)

# 저장
hwp.save("hwp/report_updated.hwp")
```

---

## ⚠️ 주의사항

1. **원본 보존**: 작업 전 반드시 백업
2. **단계별 저장**: 각 챕터 교체 후 중간 저장
3. **서식 검증**: 교체 후 즉시 확인
4. **표/그림 주의**: 자동 교체 시 위치 변경 가능성
5. **페이지 번호**: 내용 변경으로 페이지 수 변동 예상

---

## 📈 예상 소요 시간

| 단계 | 시간 | 비고 |
|------|------|------|
| 준비 및 분석 | 5분 | 자동화 |
| 스크립트 개발 | 30분 | 한 번만 개발 |
| 챕터 교체 (8개) | 60분 | 챕터당 7-8분 |
| 특수 요소 처리 | 30분 | 표/그림/목차 |
| 검증 | 15분 | 최종 확인 |
| **총 소요 시간** | **약 2시간** | |

---

## 🚀 다음 단계

1. **즉시 시작 가능한가요?**
   - → "시작" 입력 시 자동으로 진행합니다.

2. **특정 챕터만 먼저 테스트할까요?**
   - → 예: "서론만 먼저" 입력 시 1장만 교체합니다.

3. **전체 자동 실행을 원하시나요?**
   - → "전체 자동" 입력 시 전체 챕터를 순차적으로 처리합니다.

4. **수동으로 단계별 확인하며 진행할까요?**
   - → "수동 진행" 입력 시 각 단계마다 확인을 받습니다.

---

**추천**: 먼저 **서론(1장)만 테스트**하여 변환 품질을 확인한 후, 
문제가 없으면 **전체 자동 실행**하는 것을 권장합니다.

어떤 방식으로 진행할까요?

