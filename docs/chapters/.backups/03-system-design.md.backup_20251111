---
tags: [논문/시스템설계, 논문/3장]
alias: [시스템 설계, 3장, MAICE 설계]
parent: "수학 학습에서 질문 명료화를 지원하는 AI에이전트 설계 및 개발 고등학교 2학년 수학적 귀납법 단원 중심으로"
keywords: [MAICE, 멀티에이전트, 아키텍처, 질문분류]
---

# III. MAICE 교육 시스템 아키텍처

## 1. 설계 철학: "명료화 중심 학습"

### 가. 문제 인식: Freepass 방식의 근본적 한계

**[표Ⅲ-1] Freepass 방식의 교육적 한계 (예비조사 결과)**

| 한계 유형 | 발생 비율/사례 | 구체적 문제 |
|----------|:-------------:|------------|
| 질문 맥락 부재 | 72.3% | 학습 수준·목적 정보 없음 |
| 맥락 오해 | 실증 사례 | "지수의 확장"→비즈니스로 오해 |
| 수준 불일치 | 실증 사례 | 고1에게 대학 통계 개념 설명 |
| 인지 과부하 | 실증 사례 | 요청 없이 모든 개념 나열 |

주: 1장 예비조사(N=385) 결과 기반

1장에서 확인한 바와 같이, 일반적인 LLM의 Freepass 방식은 위와 같은 교육적 한계를 보였다.

이러한 문제들은 단순히 AI 성능의 문제가 아니라, **질문의 질이 낮을 때 아무리 좋은 AI도 적절한 답변을 생성할 수 없다**는 구조적 한계에서 비롯된다.

### 나. 해결 아이디어: 교육 이론 기반 에이전트 시스템

본 연구는 2장에서 검토한 교육 이론을 실제 AI 시스템으로 구현하는 것을 목표로 한다:

**Bloom의 K1-K4 분류** → **질문 유형 자동 분류 및 맞춤형 답변 생성**
- K1 (사실): 간결한 정의 중심 답변
- K2 (개념): 관계 설명 중심 답변
- K3 (절차): 단계별 안내 중심 답변
- K4 (메타인지): 메타인지 유도 중심 답변

**Dewey의 반성적 사고 5단계** → **명료화 프로세스 설계**
- 1단계 (문제 인식): "무엇이 불확실한가요?"
- 2단계 (문제 정의): "정확히 무엇을 알고 싶은가요?"
- 3단계 (가설 설정): "어떤 방법을 시도해봤나요?"
- 4단계 (가설 검증): "논리적 연결을 어떻게 보나요?"
- 5단계 (결론 도출): "최종적으로 무엇을 얻고 싶나요?"

### 다. 핵심 아이디어: 질문 → 분류 → 명료화 → 답변 파이프라인

MAICE 시스템의 핵심은 **학생의 질문을 즉시 답변하지 않고, 먼저 질문의 품질을 진단하고 필요시 명료화 과정을 거치는 것**이다.

**[그림Ⅲ-1] MAICE 질문 처리 파이프라인**

```mermaid
flowchart LR
    A[학생 질문] --> B{QC<br/>분류}
    B -->|answerable| D[AG<br/>답변생성]
    B -->|needs_clarify| C[QI<br/>명료화]
    B -->|unanswerable| E[안내]
    C -->|명료화<br/>1-3회| D
    D --> H[LO<br/>관찰]
    
    style A fill:#E3F2FD
    style B fill:#FFF9C4
    style C fill:#FFE0B2
    style D fill:#C8E6C9
    style H fill:#F3E5F5
```

이러한 파이프라인은 단순히 정보를 전달하는 것이 아니라, **학생이 스스로 질문을 구조화하고 사고를 명료화하는 과정을 경험하도록 설계**되었다.

### 라. 설계 대상: 일반 LLM보다 우수한 학습 효과

**[표Ⅲ-2] MAICE 시스템의 설계 목표**

| 목표 | Freepass 한계 | MAICE 해결책 | 기대 효과 |
|------|--------------|-------------|----------|
| 질문 품질 개선 | 맥락 72.3% 부재 | 명료화 프로세스 | 질문의 질 향상 |
| 답변 적합성 향상 | 맥락 오해, 수준 불일치 | 질문 유형 분류 (K1-K4) | 맞춤형 답변 |
| 메타인지 향상 | 사고 과정 부재 | Dewey 5단계 유도 | 자기 성찰 훈련 |

MAICE 시스템은 위 3가지 측면에서 일반 Freepass 방식보다 우수한 학습 효과를 제공하는 것을 목표로 한다.

이러한 목표를 달성하기 위해, MAICE는 ChatGPT, Claude 등 상용 AI 대화 서비스와 유사한 UX를 제공하되, 수학 학습에 특화된 3계층 구조로 설계되었다.

## 2. 전체 아키텍처 개요: 3계층 구조

MAICE 시스템은 학생이 사용하는 **대화 인터페이스**, 대화를 관리하고 데이터를 저장하는 **관리 시스템**, 그리고 지능적으로 질문을 처리하는 **에이전트 시스템**의 3계층으로 구성된다.

### 가. 계층별 역할

#### 계층 1: 대화 인터페이스 (학생이 보는 화면)

**역할**: 학생이 수식을 쉽게 입력하고 AI 답변을 실시간으로 받을 수 있는 채팅 화면

**주요 기능**:
- **수식 입력 지원**: 복잡한 수학 수식을 클릭 몇 번으로 입력 (예: $\sum_{i=1}^{n}$, $\frac{a}{b}$)
- **실시간 답변**: AI 답변이 타이핑하듯 실시간으로 표시
- **간편한 로그인**: 학교 계정으로 바로 시작
- **모바일 지원**: 핸드폰에서도 동일하게 사용 가능

**학생 경험**: ChatGPT, Claude와 동일한 UX로 별도 학습 없이 즉시 사용 가능

**[그림Ⅲ-2] MAICE 대화 인터페이스 실제 화면**

_(그림 위치: 학생이 보는 실제 채팅 화면 - 수식 입력 버튼, 실시간 답변 스트리밍, LaTeX 렌더링 포함)_

#### 계층 2: 관리 시스템 (대화 저장 및 분석)

**역할**: 모든 대화를 체계적으로 저장하고, 교사가 학생 학습 상황을 파악할 수 있도록 지원

**주요 기능**:
- **대화 기록 관리**: 학생별 모든 대화 세션을 시간 순으로 저장
- **학습 데이터 분석**: 학생의 학습 진도, 어려움 영역 자동 추출
- **교사 대시보드**: 반 전체 학습 현황 및 개별 학생 상세 정보 제공
- **권한 관리**: 학생은 본인 데이터만, 교사는 전체 데이터 접근 가능

**교육적 가치**: 교사가 30명 학생의 개별 학습 상황을 실시간 파악 가능

#### 계층 3: 에이전트 시스템 (지능적 질문 처리)

**역할**: 학생 질문을 분석하고, 필요시 명료화하며, 맞춤형 답변을 생성하는 5개 AI 에이전트

**5개 에이전트**:
1. **Question Classifier (QC)**: "이 질문은 어떤 유형인가?"
2. **Question Improver (QI)**: "질문을 더 명확하게"
3. **Answer Generator (AG)**: "유형별 맞춤 답변"
4. **Learning Observer (LO)**: "학생이 무엇을 배우고 있는가?"
5. **Free Talker (FT)**: "명료화 없이 즉시 답변"

**협업 방식**: 각 에이전트는 독립적으로 작동하되, 필요한 정보를 서로 주고받으며 협업

### 나. 전체 시스템 구조도

**[그림Ⅲ-3] MAICE 3계층 아키텍처**

```mermaid
flowchart LR
    subgraph L1["계층 1: 프론트엔드"]
        UI[대화 인터페이스]
        UI ~~~ Math[수식 입력]
    end
    
    subgraph L2["계층 2: 백엔드"]
        API[REST API]
        API ~~~ Orch[대화 조율]
    end
    
    subgraph L3["계층 3: 에이전트"]
        QC[QC<br/>분류]
        QC ~~~ QI[QI<br/>명료화]
        QI ~~~ AG[AG<br/>답변생성]
        AG ~~~ LO[LO<br/>관찰]
    end
    
    L1 -.->|HTTP 요청| L2
    L2 -.->|에이전트 호출| L3
    L3 -.->|답변 생성| L2
    L2 -.->|SSE 스트리밍| L1
    
    style L1 fill:#E3F2FD
    style L2 fill:#FFF3E0
    style L3 fill:#F3E5F5
```

### 다. 질문 처리 흐름

학생이 질문을 입력하면 다음과 같은 과정을 거친다:

**[그림Ⅲ-4] 질문 처리 시퀀스**

```mermaid
sequenceDiagram
    participant 학생
    participant UI as 대화 인터페이스
    participant BE as 관리 시스템
    participant QC as QC (분류)
    participant QI as QI (명료화)
    participant AG as AG (답변생성)
    
    학생->>UI: "수열 알려줘" 입력
    UI->>BE: 질문 전송
    BE->>QC: 질문 분류 요청
    QC-->>BE: 분류 결과
    
    alt 질문이 모호함 (needs_clarify)
        rect rgb(255, 240, 245)
        BE->>QI: 명료화 요청
        QI-->>BE: "어떤 부분이 궁금한가요?"
        BE-->>UI: 명료화 질문
        UI-->>학생: 명료화 질문 표시
        
        학생->>UI: "수열 공식들" 입력
        UI->>BE: 학생 응답 전송
        BE->>QI: 응답 전달
        QI-->>BE: 명료화 완료
        BE->>AG: 개선된 질문 전달
        end
    else 질문이 명확함 (answerable)
        rect rgb(240, 255, 240)
        BE->>AG: 바로 답변 요청
        end
    end
    
    AG-->>BE: 답변 생성 (스트리밍)
    BE-->>UI: 답변 전송
    UI-->>학생: 답변 표시
```

**핵심 특징**:
- 학생은 명료화 과정을 자연스러운 대화로 경험
- 모든 대화는 자동으로 저장되어 학습 분석에 활용
- 교사는 별도 대시보드에서 학생 학습 현황 확인

> **기술 구현 상세**: 각 계층의 구체적인 기술 스택과 구현 방법은 4장 "시스템 구현"에서 다룬다.

## 3. 5개 에이전트의 역할과 협업

MAICE 시스템의 핵심은 5개의 독립적인 AI 에이전트가 협업하여 질문을 처리하는 것이다. 각 에이전트는 특정한 교육적 목적을 가지고 설계되었다.

### 가. Question Classifier (QC): "이 질문은 어떤 유형인가?"

#### 설계 목적

1장에서 확인했듯이, 학생 질문의 72.3%가 학습 맥락 정보 없이 제출되었다. 질문의 인지적 수준에 따라 답변 방식이 달라야 하므로(K1 사실형 vs K4 메타인지형), QC는 질문을 자동으로 분류하고 명료화 필요성을 판단한다.

#### 핵심 기능

**1) 질문 유형 분류 (K1-K4)**
- K1 (사실): "수학적 귀납법의 정의가 뭐에요?" → 간결한 정의 제공
- K2 (개념): "귀납 가정은 왜 필요한가요?" → 개념 간 관계 설명
- K3 (절차): "이 등식을 어떻게 증명하나요?" → 단계별 절차 안내
- K4 (메타인지): "제가 뭘 잘못 이해한 건가요?" → 메타인지 유도 답변

**2) 명료화 필요성 판단 (3단계 게이팅)**
- **answerable**: 질문이 명확함 → AG로 전달
- **needs_clarify**: 질문이 모호함 → QI로 전달
- **unanswerable**: 답변 불가능 → 정중한 안내

**3) 명료화 질문 제안**
- needs_clarify인 경우, Dewey 5단계 기반 구체적 질문 제안
- 예: "수열 알려줘" → "어떤 부분이 궁금한지 알려줄래? 1️⃣ 정의 2️⃣ 공식 3️⃣ 문제 풀이"

#### 설계 흐름

**[그림Ⅲ-5] QC 3단계 게이팅**

```mermaid
flowchart TD
    Q[학생 질문] --> C{QC<br/>분류}
    C -->|answerable| A[AG<br/>답변생성]
    C -->|needs_clarify| I[QI<br/>명료화]
    C -->|unanswerable| U[안내 메시지]
    
    style A fill:#90EE90
    style I fill:#FFD700
    style U fill:#FFB6C1
```

> **구현 상세**: 프롬프트 설계 및 코드는 4장 참조

### 나. Question Improver (QI): "질문을 더 명확하게"

#### 설계 목적

QC가 "명료화 필요" 판정을 내리면, QI는 학생이 스스로 질문을 구체화하도록 돕는다. Dewey의 반성적 사고 이론에 따르면, 학생이 자신의 어려움을 명확히 인식하고 표현하는 과정에서 메타인지 능력이 향상된다.

#### 핵심 설계: Dewey 5단계 기반 명료화

QI는 Dewey의 5단계를 대화형 질문으로 변환하여, 질문 유형(K1-K4)과 모호성 수준에 따라 1-3회 명료화를 수행한다:

**[표Ⅲ-9] Dewey 5단계 기반 명료화 전략**

| Dewey 단계 | 명료화 질문 예시 | 학생 경험 |
|-----------|----------------|----------|
| **1단계: 문제 인식** | "무엇이 불확실한가요?" | 막연한 어려움 → 구체적 문제 인식 |
| **2단계: 문제 정의** | "정확히 무엇을 알고 싶은가요?" | "어려워요" → "귀납 단계가 어려워요" |
| **3단계: 가설 설정** | "어떤 방법을 시도해봤나요?" | 학생의 시도와 이해 수준 파악 |
| **4단계: 가설 검증** | "왜 그렇게 생각했나요?" | 학생의 사고 과정 드러내기 |
| **5단계: 결론 도출** | "최종적으로 무엇을 얻고 싶나요?" | 학습 목표 명확화 |

#### 명료화 전략: 질문 유형별 차별화

질문 유형(K1-K4)과 모호성 수준에 따라 명료화 전략을 조절한다:

- **K1 (즉답형)**: 선택지 제공으로 빠르게 범위 좁히기 (1회)
- **K2 (설명형)**: 비교 대상이나 설명 깊이 확인 (1-2회)
- **K3 (적용형)**: 구체적인 문제 상황이나 막힌 단계 파악 (1-2회)
- **K4 (문제해결형)**: Dewey 5단계를 깊이 적용, 사고 과정 드러내기 (2-3회)

#### 명료화 완료 판단

QI는 학생의 각 응답을 평가하여, 충분한 정보가 모였는지 판단한다:

**[그림Ⅲ-6] 명료화 프로세스 흐름**

```mermaid
flowchart LR
    C[QC<br/>needs_clarify] --> Loop["명료화 반복<br/>━━━━━━━━<br/>질문 → 학생 응답<br/>━━━━━━━━<br/>최대 3회"]
    Loop --> E{정보<br/>충분?}
    E -->|YES| F[최종 질문<br/>생성]
    E -->|NO<br/>3회 미만| Loop
    E -->|NO<br/>3회 도달| F
    F --> AG[AG<br/>답변생성]
    
    style Loop fill:#FFE0B2
    style E fill:#FFD700
    style F fill:#B3E5FC
    style AG fill:#C8E6C9
```

**판단 기준**:
- **PASS**: 원본 질문의 의도가 명확해지고, 답변 생성에 필요한 정보 확보
- **NEED_MORE**: 원본 질문의 의도가 여전히 불분명하거나, 추가 정보 필요
- **최대 3회 제한**: 3회 명료화 후에도 불충분하면 현재 정보로 답변 생성

#### 교육적 의도 명시화

기존 LLM은 "왜 명료화 질문을 하는지" 설명하지 않아 학생이 불편함을 느꼈다. QI는 명료화의 교육적 이유를 부드럽게 설명한다:

**기본 프레이밍**:
```
"질문을 조금만 더 구체적으로 만들어주면,
 딱 맞는 설명을 해드릴 수 있어요! 😊"
```

**교육적 프레이밍** (K4 수준 학생):
```
"함께 질문을 구체화해볼까요? 🎯
 네가 정확히 무엇을 모르는지 찾아가는 과정이
 진짜 학습의 시작이에요!"
```

#### 질문 유형 재분류

명료화 과정에서 학생의 실제 어려움이 드러나면, 질문 유형이 변경될 수 있다:

**[그림Ⅲ-7] 질문 유형 재분류 예시**

```mermaid
flowchart LR
    Q1["원본 질문<br/>💬 수열 알려줘"] --> C1["QC<br/>1차 분류<br/>📋 K1 사실형"]
    C1 --> QI["QI<br/>명료화<br/>❓ 어떤 부분이<br/>궁금한가요?"]
    QI --> A["학생 응답<br/>💭 등차수열과<br/>등비수열의<br/>차이를 모르겠어요"]
    A --> C2["QC<br/>재분류<br/>📋 K2 개념형"]
    C2 --> AG["AG<br/>K2 답변 전략<br/>✓ 비교/대조 중심<br/>✓ 관계 설명"]
    
    style Q1 fill:#E3F2FD
    style C1 fill:#FFF9C4
    style QI fill:#FFE0B2
    style A fill:#F3E5F5
    style C2 fill:#C8E6C9
    style AG fill:#B2DFDB
```

> **구현 상세**: 명료화 프롬프트 템플릿 및 평가 로직은 4장 참조

### 다. Answer Generator (AG): "유형별 맞춤 답변"

#### 설계 목적

1장에서 확인한 AI 답변의 문제는 "모든 학생에게 동일한 방식으로 설명"하여 인지 과부하를 유발했다. AG는 Bloom의 K1-K4 분류에 따라 답변 구조와 교수법을 차별화한다.

#### 핵심 설계: K1-K4별 답변 차별화

**[표Ⅲ-10] K1-K4별 답변 구조 및 교수법**

| 유형 | 답변 구조 | 교수법 특징 |
|------|----------|------------|
| **K1 (사실)** | 정의 → 핵심 예시 → 보충 | 간결함, 정확성 우선 (3-5문장) |
| **K2 (개념)** | 개념 관계 → 비교/대조 → 시각화 | "왜?" 중심 설명, 논리적 연결 |
| **K3 (절차)** | 전체 개요 → 단계별 안내 → 실수 방지 | 선택권 제공, 대화형 진행 |
| **K4 (메타인지)** | 문제 분석 → 자기 점검 → 대안 탐색 | 답 직접 제공 X, 사고 과정 유도 |

#### 주요 설계 특징

**교육과정 표준 준수**: 대한민국 교육과정 표준 용어 사용 (부등식, 일반항, 도함수 등)

**실시간 스트리밍**: 답변을 타이핑하듯 실시간 전송하여 학생이 자연스러운 대화 경험

**LaTeX 수식 렌더링**: 인라인(`$수식$`) 및 블록(`$$수식$$`) 수식 지원

> **구현 상세**: K1-K4별 프롬프트 템플릿, 답변 예시, 스트리밍 로직은 4장 참조

### 라. Learning Observer (LO): "대화 요약 및 컨텍스트 관리"

#### 설계 목적

긴 대화 세션에서 컨텍스트 길이 증가와 맥락 손실을 방지하기 위해, LO는 대화를 주기적으로 요약하여 핵심 내용만 유지한다.

#### 핵심 기능

**2단계 요약 전략**: 
1. **기본 요약** 즉시 생성 및 백엔드 전송 (빠른 응답)
2. **LLM 향상 요약** 백그라운드에서 비동기 생성 (품질 향상, 30초 타임아웃)

**맥락 유지**: 토큰 효율성 확보 + 학습 연속성 지원

**[표Ⅲ-3] LO 관찰 및 추출 정보**


| 관찰 항목 | 설명 | 예시 |
|----------|------|------|
| **세션 제목** | 대화의 핵심 주제 요약 | "수학적 귀납법 귀납 단계 증명" |
| **질문 요약** | 학생이 궁금해한 내용 | "n² < 2ⁿ을 수학적 귀납법으로 증명하는 방법" |
| **명료화 과정** | 명료화 진행 여부 및 내용 | "2회 명료화: 증명 단계 → 귀납 가정 적용" |
| **답변 요약** | 제공된 학습 내용 핵심 | "기본 단계(n=1)와 귀납 단계(n=k→k+1) 설명" |
| **핵심 개념** | 학습한 주요 수학 개념 | 수학적 귀납법, 귀납 가정, 귀납 단계 |
| **학습 진행 상태** | 학생 이해도 변화 추적 | "기본 단계 이해 → 귀납 단계 적용 학습 중" |
> **구현 상세**: 요약 알고리즘 및 DB 구조는 4장 참조

### 마. Free Talker (FT): "대조군 (Freepass 모드)"

#### 설계 목적

명료화 프로세스의 효과를 검증하기 위한 A/B 테스트 대조군. 일반 ChatGPT, Claude처럼 명료화 없이 즉시 답변한다.

#### 핵심 특징

**즉시 답변**: 질문 분류, 명료화 없이 바로 답변 생성

**A/B 테스트**: 학생 58명을 무작위로 Agent(28명) / Freepass(30명) 배정

**[표Ⅲ-4] Agent vs Freepass 모드 기능 비교**

| 항목 | Agent 모드 | Freepass 모드 |
|------|-----------|---------------|
| **질문 분류** | ✓ K1-K4 분류 | ✗ 분류 없음 |
| **명료화** | ✓ needs_clarify 시 명료화 | ✗ 명료화 없음 |
| **답변 전략** | ✓ K1-K4별 차별화 | ✗ 동일한 방식 |

**대조군의 중요성**:
- Agent 모드의 효과를 **인과적으로 검증** 가능
- 선택 편향(selection bias) 제거
- "명료화가 정말 도움이 되는가?" 실증적 답변 제공

#### 검증 계획

FT를 활용한 A/B 테스트를 통해 다음을 비교 검증할 예정이다:

**비교 차원**:
1. **즉시 효과**: 단일 세션에서 질문-답변 품질 비교
2. **누적 효과**: 다회 세션 시 학습 진행 패턴 비교  
3. **학습자 수준별 효과**: 상위권/하위권 학생에 대한 차별적 효과 분석

**기대 가설**:
- 명료화 프로세스는 단일 세션에서는 시간이 더 소요되나, 장기적으로 질문 능력과 메타인지 향상에 기여할 것
- 특히 절차적 지식이 부족한 하위권 학생들에게 더 큰 학습 효과가 나타날 것

검증 결과는 8장에서 상세히 분석한다.

> **구현 상세**: FT의 프롬프트 및 A/B 테스트 무작위 배정 로직은 4.2절에서 다룬다.

---

**III장 요약**: 본 장에서는 MAICE 시스템의 설계 철학, 3계층 아키텍처, 5개 에이전트(QC, QI, AG, LO, FT)의 역할과 협업 방식을 살펴보았다. 다음 4장에서는 이러한 아키텍처를 실제로 구현한 기술 스택, 코드 구조, 프롬프트 엔지니어링 기법, 그리고 베타테스트를 통한 시스템 안정화 과정을 다룬다.
